---
import { isLoggedIn } from "../utils"

// if already logged in, redirect to dashboard
const token = (Astro.cookies.get("token") || {})?.value
const tokenExpiry = (Astro.cookies.get("tokenExpiry") || {})?.value

if (isLoggedIn({ token, tokenExpiry })) {
    return Astro.redirect("/dashboard")
}

const { errorMsg } = Astro.props
---
<form action="/actions/login" method="post">
    <input type="text" name="username" placeholder="Username" required>
    <input type="password" name="password" placeholder="Password" required>
    <button>Login</button>
    
    {errorMsg && <p>{errorMsg}</p>}
</form>