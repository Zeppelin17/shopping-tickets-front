---
import { getShops } from "../utils"
const { token, errorMsg, successMsg, item } = Astro.props

const shops = await getShops(token)
---
<form action="/actions/ticket" method="POST">
    <input type="hidden" name="id" value={item && item.id}>
    <input type="date" name="date" placeholder="Fecha" value={item && item.date} required>
    <input type="number" step="0.01" name="amount" placeholder="Total" value={item && item.amount} required>
    <select name="shop" required>
        <option value="">Tienda</option>
        {shops.map((shop) => {            
            const attributes = {
                ...(item.shop === shop.id && {selected: "selected"})
            }

            return <option value={shop.id} {...attributes}>{shop.name}</option>
        })}
    </select>
    
    <button>{item ? "Editar" : "Crear"}</button>

    {errorMsg && <p>{errorMsg}</p>}
    {successMsg && <p>{successMsg}</p>}
</form>